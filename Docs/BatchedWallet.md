# BatchedWallet

## Overview

The BatchedWallet is a simple implementation of the erc4337 standard.
It allows to batch transactions, and includes required functions to use "Entrypoints".

Entrypoints are contracts that are deployed on each chain ones, and should be used by all erc4337 wallets.
Read more at: https://www.erc4337.io/docs/understanding-ERC-4337/entry-point-contract

The BatchedWallet is a fork of [SimpleAccount](https://github.com/eth-infinitism/account-abstraction/blob/develop/contracts/samples/SimpleAccount.sol)

Changes to forked contract:  
- use recent OZ version
- remove _disableInitializers() from the constructor

In normal operation the wallet is generated by an entrypoint and used through proxy contracts.  
For this reason it is important to disable the Initializer is the implementation contract.  
Removing this is not dangerous for this test case.  

## Functions

### State Chaining functions

`execute(dest,value,func)` executes call on dest with provided value and data.

`executeBatch(dest[],value[],func[])` executes multiple calls from this account. Caller needs to be entryPoint or owner.

`initialize()` Initializes this contract.

`addDeposit()` deposits msg.value to entrypoint.

`withdrawDepositTo(withdrawAddress,amount)` withdraws amount to withdrawAddress from entrypoint. Caller needs to be the owner.


### View Functions

`entryPoint()` returns the EntryPoint of this wallet.

`_onlyOwner()` returns true if msg.sender is the owner or the wallet itself (self call).

`_requireFromEntryPointOrOwner()` returns true if msg.sender is the owner or the entryPoint.

`getDeposit()` returns the amount deposited to entryPoint.

## Modifier

`onlyOwner()` modifier allows for access control, only the owner of this contract can call functions using this modifier.

## State

`address public owner;` the address of the contract owner.

`IEntryPoint private immutable _entryPoint;` the address of the entrypoint, this can not be changed after set!